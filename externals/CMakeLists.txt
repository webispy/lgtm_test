include(ExternalProject)

# nghttp2
ExternalProject_Add(NGHTTP2
	SOURCE_DIR ${CMAKE_SOURCE_DIR}/externals/nghttp2
	DOWNLOAD_COMMAND ""
	BUILD_ALWAYS 1
	CMAKE_ARGS
		-DCMAKE_TOOLCHAIN_FILE=${CMAKE_TOOLCHAIN_FILE}
		-DCMAKE_VERBOSE_MAKEFILE=ON
		-DCMAKE_C_FLAGS=${CUSTOM_C_FLAGS}
		-DCMAKE_LIBRARY_ARCHITECTURE=${CMAKE_LIBRARY_ARCHITECTURE}
		-DCMAKE_C_COMPILER=${CMAKE_C_COMPILER}
		-DCMAKE_CXX_COMPILER=${CMAKE_CXX_COMPILER}
		-DPKG_CONFIG_EXECUTABLE=${PKG_CONFIG_EXECUTABLE}
		-DCMAKE_SYSTEM_PROCESSOR=${CMAKE_SYSTEM_PROCESSOR}
		-DENABLE_LIB_ONLY=1
		-DENABLE_SHARED_LIB=0
		-DENABLE_STATIC_LIB=1
		-DCMAKE_INSTALL_PREFIX=${CMAKE_BINARY_DIR}/nghttp2
		# Set the 'LIBDIR' value to not use the multiarch path in the library installation path.
		-DCMAKE_INSTALL_LIBDIR=${CMAKE_BINARY_DIR}/nghttp2/lib
)
